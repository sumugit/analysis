math01 <- read.csv("math2020.csv", fileEncoding = "Shift-JIS")
math<-matrix(c(478,2.2,1.8,0.9,1.6,0.4,1.2,1.6,0.7,20,28,45,41,87,22,29,13,8,80,65,5,69,21,92,1,67,54,59,45,82,40,76,
505,1.3,2,0.9,1.7,1,1.6,0.7,1.3,31,30,18,50,49,2,56,8,4,46,10,13.57926829,69,26,98,0.4,74,53,51,39,64,23,69,
401,2.1,2,1.2,1.6,1.2,1.5,0.9,1.4,17,31,40,44,50,2,37,14,69,65,15,16,89,25,75,0.6,83,47,70,56,92,47,41,
537,1.6,2.1,1,1.9,0.9,1.6,0.5,1.3,12,34,20,45,75,0,40,1,3,52,9,13.75,80,47,89,0.2,50,45,29,32,78,22,62,
366,1.9,1.4,0.5,2.1,2.3,1.5,1.8,0.7,4,13,65,38,27,7,24,9,37,93,44,13,44,5,97,0.6,86,47,84,71,78,46,23,
476,1.7,2.5,1.1,2.6,1.5,1.2,0.7,1,28,25,22,33,88,3,9,5,29,91,53,12,78,4,84,0.3,71,36,48,26,88,28,51,
387,1.4,2.2,0.7,2.3,1.5,1.8,0.6,0.7,5,27,34,35,54,6,75,16,14,48,10,15,64,22,96,0.3,75,38,66,87,84,75,55,
585,1.3,1.7,1.4,1.4,0.7,1,1,1.4,15,30,13,26,46,3,89,9,34,71,29,12,69,51,98,0.2,46,39,25,27,58,24,23,
459,1.7,2.1,1.3,2.1,1,1.7,0.9,1.2,11,35,36,46,63,6,65,7,65,92,35,8,64,22,100,0.6,74,46,53,50,86,68,38,
406,1.7,0.8,0.7,0.8,1.3,1.1,1,0.6,6,18,61,58,14,37,49,25,0,68.95348837,23,18,87,47,70,0.6,84,56,82,63,85,41,54.65116279,
531,1.5,2.3,1.1,2.8,1.1,1.4,0.7,1.5,45,23,14,41,89,8,74,12,5,69,12,13.5,73,8,95,0.4,68,46,38,62,91,80,25,
276,1.4,0.7,0.6,1.2,1.5,1.3,1.7,0.8,10,16,53,43,11,30,40,22,61,85,48,25,96,8,91,0.8,88,46,82,63,75,36,25,
586,1.5,2.3,2,1.6,0.7,1,1.1,2,9,27,15,30,53,1,64,6,2,61,26,13.5,82,27,94,0.1,70,38,35,26,60,40,72,
529,1.7,2.1,1.1,2.2,1.1,1.5,0.8,0.6,31,29,17,44,85,3,44,5,19,73,8,11,83,30,91,0.2,77,45,47,63,98,68,86,
411,1.7,1.5,0.5,1.3,2.2,1.1,1.1,0.3,1,19,21,27,53,35,64,30,28,89,45,15,49,9,99,0.8,90,30,71,50,61,25,52,
411,2.1,1.6,0.4,1.4,1.5,1.4,1,0.2,7,17,58,35,39,2,58,41,52,98,63,14.3,73,36,91,0.7,73,30,70,69,92,64,47,
496,1.5,2.5,1.9,2.3,1.4,1.6,0.9,1.8,22,33,27,59,79,1,68,27,8,53,50,16,69,13,83,0.6,75,61,56,44,82,71,58,
484,2.2,1.8,1,2.6,1.1,1.8,0.7,0.6,19,25,16,46,80,2,28,20,16,68,71,20,87,56,97,0.9,55,52,32,31,89,57,48,
570,1,2.7,0.9,1.6,0.6,1.3,0.9,0.6,17,32,9,17,32,9,71,36,37,14,7,10.7,80,12,74,0.1,47,39,17,14,44,21,89,
424,2,1.5,0.9,1.2,1.3,1.2,0.9,0.6,9,28,50,49,49,10,69,27,55,89,30,12,76,34,73,0.6,88,52,81,72,88,42,38,
589,1.1,1.7,1.5,1.8,0.7,0.7,0.6,1.7,19,33,9,30,67,2,36,18,35,27,9,12.5,84,51,83,0.1,56,43,18,50,75,52,28,
508,1.8,2.4,1,2.8,1.6,1.3,0.8,0.8,28,31,14,34,92,6,72,9,47,77,17,14,67,8,82,0.5,77,45,50,43,80,54,81,
433,2.3,1.8,1.3,1.6,1.3,1.6,1,1,8,25,50,43,46,8,61,29,6,76,49,15,36,66,79,0.8,81,48,71,43,89,56,24,
502,1.8,2.1,1.1,2.6,1.6,1.1,0.6,0.7,12,34,18,36,91,3,76,21,1,30,13,13,76,6,92,0.3,84,57,53,52,92,58,85,
435,1.3,2.3,1.3,2.2,1.6,1.8,1,0.9,8,28,36,33,68,8,67,21,24,96,22,9,76,24,90,0.7,71,33,55,57,76,58,52,
508,1.9,2.1,0.8,1.5,1.7,1.1,1.2,0.6,5,28,41,39,72,8,64,24,46,95,60,9,73,18,96,0.3,87,64,78,64,78,40,9,
460,2.1,1.9,0.7,2,2.2,1.3,1.1,0.7,8,23,23,30,87,20,45,29,15,72,43,13,82,15,64,0.5,73,46,61,63,85,44,29,
387,1.8,1.3,2.3,1.3,1.8,1.5,1.3,2.6,5,21,0.6,40,15,0,56.59090909,18,1,68.95348837,54,15,33,26,70,2.8,88,46,85,45,81,45.06818182,54.65116279,
536,1.4,2.1,1.2,2,0.8,1.7,0.5,1.5,21,31,6,45,32,2,43,34,0,70,7,13.57926829,53,17,95,0.8,52,47,16,26,62,19,95,
494,1.2,2.1,1,1.8,1,1.5,0.7,1.3,25,31,23,43,45,2,61,12,4,29,7,13.57926829,76,11,95,0.6,72,47,56,57,75,35,72,
461,1.4,2.2,1.2,2.7,1,1.8,0.6,1.2,27,33,22,43,36,10,33,2,0,45,25,12,71,20,94,0.7,70,44,45,46,60,32,72,
390,1.9,1.2,0.7,1.3,1.5,1.1,1,0.5,7,24,45,43,49,2,79,28,1,71,30,15,76,29,70,0.6,85,49,77,72,92,43,24,
378,1.5,1.6,0.6,1.7,1.9,1.4,1.2,0.5,3,17,38,29,73,6,68,26,28,90,24,15,47,7,89,0.8,80,42,73,63,78,56,37,
475,2.3,2,0.9,2.1,1.7,1.3,1,0.8,12,29,21,30,51,10,68,13,52,88,78,12,84,22,80,0.5,68,38,53,57,90,74,35,
508,2.3,2,1,2.5,1.6,1.3,1.1,0.4,21,32,17,43,95,12,64,20,20,89,56,15,76,9,84,0.2,78,62,55,24,93,14,78,
332,1.6,1.6,1.1,1.3,1.5,1.2,0.9,0.8,10,25,34,41,42,2,61,25,59,81,14,12,64,34,58,0.8,82,45,63,48,75,21,7,
498,1,2.2,1.4,2.7,0.8,1.7,0.6,1.7,17,29,18,52,50,9,77,8,2,60,3,10,58,14,92,0.5,72,54,54,41,69,25,99,
477,1.4,2.1,1,2.1,1.3,1.7,0.8,0.6,6,27,23,44,58,15,45,15,36,92,34,16,76,16,87,0.3,64,43,43,57,85,58,88,
605,1.8,2.3,1.4,1.7,0.7,1.4,0.9,1.6,14,33,33,39,67,3,78,10,0,33,59,15,80,41,98,0.2,77,50,63,32,48,27,85,
508,1.2,2.5,1.1,2.8,1.5,1.9,0.9,0.6,12,41,7,40,79,1,41,5,23.18181818,75,5,14,62,31,95,0.4,78,42,47,66,84,66,92,
493,1.6,2.2,1.3,2,1.2,1.7,0.8,1.1,13,38,13,40,87,0,88,6,40,62,13,13,80,30,94,0.4,72,41,25,58,74,46,88,
264,2,1.5,0.7,2,1.8,1.6,1.6,0.8,6,14,56,37,40,7,43,23,6,85,26,13,33,6,94,0.8,84,42,79,59,67,36,45,
499,1.2,2.1,1.1,2.8,1,1.6,0.6,1.7,32,27,15,49,44,4,50,6,1,54,17,13.5,53,7,98,0.4,57,49,29,40,60,54,84,
410,2.2,1.4,0.8,1.5,1.9,1.5,1.3,0.7,4,22,45,44,32,1,42,11,44,77,12,17,42,17,40,0.6,88,46,79,38,80,35,8,
504,1.4,2.2,1.1,2.4,1.2,1.8,0.7,1.8,24,28,22,51,65,4,75,25,6,54,27,13.57926829,98,18,98,0.6,77,54,58,66,80,62,55)
,ncol=32,byrow=T)
colname<-c("å¹³åE‚¹","å®¿é¡E,"ãƒEƒ¬ãƒE,"ã‚²ãƒ¼ãƒ
","å‹é”","å®¶ã®æ‰‹ä¼ã„","ã‚¹ãƒãEãƒE,"æœ¬","ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒE,"è”µæ›¸200","è”µæ›¸26","æ¥½ã—ã„","è‡ªä¿¡","æ•™å¸«ç‰¹æ€§","æ•™å¸«ç›¸äºE,"ç ”ä¿®æŒE°Žæ³E,"å›³è¡¨","é›»åE,"PC","å®¿é¡Œé«E,"æ™‚é–“æ•°","TIMSS","å•é¡Œè¡Œå‹•","ä¿è­·è€E,"ãƒã‚¤ãƒE,"å°±è·","å¾—æ„","ç©æ¥µæ€§","æ—¥å¸¸ç”Ÿæ´»","èª¬æ˜E,"è¤E›‘","å‡ºé¡Œå½¢å¼E)
rowname<-c("ã‚¢ãƒ«ãƒ¡ãƒ‹ã‚¢","ã‚ªãƒ¼ã‚¹ãƒˆãƒ©ãƒªã‚¢","ãƒãEãƒ¬ãƒ¼ãƒ³","ãƒ™ãƒ«ã‚®ãƒ¼","ãƒœãƒ„ãƒ¯ãƒE,"ãƒ–ãƒ«ã‚¬ãƒªã‚¢","ãƒãƒª","å°æ¹¾","ã‚­ãƒ—ãƒ­ã‚¹","ã‚¨ã‚¸ãƒ—ãƒˆ","ã‚¨ã‚¹ãƒˆãƒ‹ã‚¢","ã‚¬ãƒ¼ãƒE,"é¦™æ¸¯","ãƒãƒ³ã‚¬ãƒªãƒ¼","ã‚¤ãƒ³ãƒ‰ãƒã‚·ã‚¢","ã‚¤ãƒ©ãƒ³","ã‚¤ã‚¹ãƒ©ã‚¨ãƒ«","ã‚¤ã‚¿ãƒªã‚¢","æ—¥æœ¬","ãƒ¨ãƒ«ãƒ€ãƒ³","éŸ“å›½","ãƒ©ãƒˆãƒ“ã‚¢","ãƒ¬ãƒãƒŽãƒ³","ãƒªãƒˆã‚¢ãƒ‹ã‚¢","ãƒžã‚±ãƒ‰ãƒ‹ã‚¢","ãƒžãƒ¬ãƒ¼ã‚·ã‚¢","ãƒ¢ãƒ«ãƒ‰ãƒ","ãƒ¢ãƒ­ãƒE‚³","ã‚ªãƒ©ãƒ³ãƒ€","ãƒ‹ãƒ¥ãƒ¼ã‚¸ãƒ¼ãƒ©ãƒ³ãƒE,"ãƒŽãƒ«ã‚¦ã‚§ã‚¤","ãƒ‘ãƒ¬ã‚¹ãƒãƒŠ","ãƒ•ã‚£ãƒªãƒ”ãƒ³","ãƒ«ãƒ¼ãƒžãƒ‹ã‚¢","ãƒ­ã‚·ã‚¢","ã‚µã‚¦ã‚¸ã‚¢ãƒ©ãƒ“ã‚¢","ã‚¹ã‚³ãƒEƒˆãƒ©ãƒ³ãƒE,"ã‚»ãƒ«ãƒ“ã‚¢","ã‚·ãƒ³ã‚¬ãƒãEãƒ«","ã‚¹ãƒ­ãƒã‚­ã‚¢","ã‚¹ãƒ­ãƒ™ãƒ‹ã‚¢","å—ã‚¢ãƒ•ãƒªã‚«","ã‚¹ã‚§ãƒ¼ãƒEƒ³","ãƒãƒ¥ãƒ‹ã‚¸ã‚¢","ã‚¢ãƒ¡ãƒªã‚«")
setwd("C:/Users/diddy/Google ãƒ‰ãƒ©ã‚¤ãƒEå¤šå¤‰é‡è§£æžEãƒšã‚¢ãƒ¯ãƒ¼ã‚¯/pca")
x <- read.csv("boston.csv",fileEncoding = "Shift-Jis") #ãƒEEã‚¿ã®èª­ã¿è¾¼ã¿
u <- x
p <- ncol(x) #å¤‰æ•°ã®æ•°
MEAN <- as.numeric(apply(x,2,mean))
SD <- as.numeric(apply(x,2,sd))
j <- 1 #æ¨™æº–åŒ–
for (i in 1:p) {
u[j] <- x[j]- MEAN[j]
u[j] <- u[j]/SD[j]
j <- j+1
}
R <- cor(u) #ç›¸é–¢ä¿‚æ•°
z <- eigen(R)
Î» <- z$values #å›ºæœ‰å€¤
z <- z$vectors #å›ºæœ‰ãEã‚¯ãƒˆãƒ«
U <- data.matrix(u)
Z <- U%*%z #ä¸»æˆåEå¾—ç‚¹
ÎE<- Î»/p #å¯E¸ŽçŽ‡
CÎE<- ÎE#ç´¯ç©å¯E¸ŽçŽ‡
j <- 0
for (i in 1:(p-1)) {
j <- j+1
CÎ›[j+1] <- CÎ›[j] + CÎ›[j+1]
}
r <- matrix(1:p^2,nrow=p,ncol=p) #å›
å­è²
è·é‡Ej <- 1
for (i in 1:p) {
r[j,] <- sqrt(Î»[j])*z[,j]
j <- j+1
}
write.table("å›ºæœ‰å€¤",file="output.txt",append=T,quote=F,col.names=F)
write.table(t(Î»),file="output.txt",append=T,quote=F,col.names=F)
write.table("å›ºæœ‰ãEã‚¯ãƒˆãƒ«",file="output.txt",append=T,quote=F,col.names=F)
write.table(z,file="output.txt",append=T,quote=F,col.names=F)
write.table("å¯E¸ŽçŽ‡",file="output.txt",append=T,quote=F,col.names=F)
write.table(t(ÎE,file="output.txt",append=T,quote=F,col.names=F)
write.table("ç´¯ç©å¯E¸ŽçŽ‡",file="output.txt",append=T,quote=F,col.names=F)
write.table(t(CÎE,file="output.txt",append=T,quote=F,col.names=F)
write.table("å›
å­è²
è·é‡E,file="output.txt",append=T,quote=F,col.names=F)
write.table(t(colnames(x)),file="output.txt",append=T,quote=F,col.names=F)
write.table(r,file="output.txt",append=T,quote=F,col.names=F)
write.table("ä¸»æˆåEå¾—ç‚¹",file="output.txt",append=T,quote=F,col.names=F)
write.table(Z,file="output.txt",append=T,quote=F,col.names=F)
#å›
å­è²
è·é‡æ•£å¸E›³
hplot<-function(i,j){		#é–¢æ•°èª­ã¿è¾¼ã¿
png(paste("pca1-", as.character(i), "-", as.character(j), ".png"))
xl<-paste("ç¬¬",i,"ä¸»æˆåE")
yl<-paste("ç¬¬",j,"ä¸»æˆåE")
plot(r[i,],r[j,],type="n",xlab=xl,ylab=yl)
text(r[i,],r[j,],colnames(x))
dev.off()
}
#å®Ÿè¡Œã‚³ãƒžãƒ³ãƒ‰ã€‚ï¼‘ï¼Œï¼’ã¨ãªã£ã¦ãE‚‹ã¨ã“ã‚ã‚’æ•£å¸E›³ã‚’æããŸãE¸»æˆåEã«å¤‰æ›´ã—ã¦ä½¿ç”¨ã™ã‚‹
#ä¾‹ãEå ´åˆã€ç¬¬E‘ä¸»æˆåEã¨ç¬¬E’ä¸»æˆåEã®å›
å­è²
è·é‡ãEæ•£å¸E›³ãŒä½œæEã•ã‚Œã‚Ehplot(1,2)
#ä¸»æˆåEå¾—ç‚¹æ•£å¸E›³
splot<-function(i,j){
png(paste("pca1-", as.character(i), "-", as.character(j), ".png"))
xl<-paste("ç¬¬",i,"ä¸»æˆåE")
yl<-paste("ç¬¬",j,"ä¸»æˆåE")
plot(Z[,i],Z[,j],xlab=xl,ylab=yl)
text(Z[19,i],Z[19,j],"â—E)
dev.off()
}
#å®Ÿè¡Œã‚³ãƒžãƒ³ãƒ‰ã€‚ï¼‘ï¼Œï¼’ã¨ãªã£ã¦ãE‚‹ã¨ã“ã‚ã‚’æ•£å¸E›³ã‚’æããŸãE¸»æˆåEã«å¤‰æ›´ã—ã¦ä½¿ç”¨ã™ã‚‹
#ä¾‹ãEå ´åˆã€ç¬¬E‘ä¸»æˆåEã¨ç¬¬E’ä¸»æˆåEã®ä¸»æˆåEå¾—ç‚¹ã®æ•£å¸E›³ãŒä½œæEã•ã‚Œã‚Esplot(1,2)
hplot<-function(i,j){		#é–¢æ•°èª­ã¿è¾¼ã¿
png(paste("pca1-", as.character(i), "-", as.character(j), ".png"))
xl<-paste("ç¬¬",i,"ä¸»æˆåE")
yl<-paste("ç¬¬",j,"ä¸»æˆåE")
plot(r[i,],r[j,],type="n",xlab=xl,ylab=yl)
text(r[i,],r[j,],colnames(x))
dev.off()
}
hplot(1,2)
splot<-function(i,j){
png(paste("pca1-", as.character(i), "-", as.character(j), ".png"))
xl<-paste("ç¬¬",i,"ä¸»æˆåE")
yl<-paste("ç¬¬",j,"ä¸»æˆåE")
plot(Z[,i],Z[,j],xlab=xl,ylab=yl)
text(Z[19,i],Z[19,j],"â—E)
dev.off()
}
splot(1,2)
splot<-function(i,j){
png(paste("pca1-", as.character(i), "-", as.character(j), ".png"))
xl<-paste("ç¬¬",i,"ä¸»æˆåE")
yl<-paste("ç¬¬",j,"ä¸»æˆåE")
plot(Z[,i],Z[,j],xlab=xl,ylab=yl)
#text(Z[19,i],Z[19,j],"â—E)
dev.off()
}
splot(1,2)
#å›
å­è²
è·é‡æ•£å¸E›³
hplot<-function(i,j){		#é–¢æ•°èª­ã¿è¾¼ã¿
png(paste("pca1-", as.character(i), "-", as.character(j), ".png"))
xl<-paste("ç¬¬",i,"ä¸»æˆåE")
yl<-paste("ç¬¬",j,"ä¸»æˆåE")
plot(r[i,],r[j,],type="n",xlab=xl,ylab=yl)
#text(r[i,],r[j,],colnames(x))
dev.off()
}
#å®Ÿè¡Œã‚³ãƒžãƒ³ãƒ‰ã€‚ï¼‘ï¼Œï¼’ã¨ãªã£ã¦ãE‚‹ã¨ã“ã‚ã‚’æ•£å¸E›³ã‚’æããŸãE¸»æˆåEã«å¤‰æ›´ã—ã¦ä½¿ç”¨ã™ã‚‹
#ä¾‹ãEå ´åˆã€ç¬¬E‘ä¸»æˆåEã¨ç¬¬E’ä¸»æˆåEã®å›
å­è²
è·é‡ãEæ•£å¸E›³ãŒä½œæEã•ã‚Œã‚Ehplot(1,2)
#ä¸»æˆåEå¾—ç‚¹æ•£å¸E›³
splot<-function(i,j){
png(paste("pca1-", as.character(i), "-", as.character(j), ".png"))
xl<-paste("ç¬¬",i,"ä¸»æˆåE")
yl<-paste("ç¬¬",j,"ä¸»æˆåE")
plot(Z[,i],Z[,j],xlab=xl,ylab=yl)
#text(Z[19,i],Z[19,j],"â—E)
dev.off()
}
#å®Ÿè¡Œã‚³ãƒžãƒ³ãƒ‰ã€‚ï¼‘ï¼Œï¼’ã¨ãªã£ã¦ãE‚‹ã¨ã“ã‚ã‚’æ•£å¸E›³ã‚’æããŸãE¸»æˆåEã«å¤‰æ›´ã—ã¦ä½¿ç”¨ã™ã‚‹
#ä¾‹ãEå ´åˆã€ç¬¬E‘ä¸»æˆåEã¨ç¬¬E’ä¸»æˆåEã®ä¸»æˆåEå¾—ç‚¹ã®æ•£å¸E›³ãŒä½œæEã•ã‚Œã‚Esplot(1,2)
x <- read.csv("boston.csv",fileEncoding = "Shift-Jis") #ãƒEEã‚¿ã®èª­ã¿è¾¼ã¿
u <- x
p <- ncol(x) #å¤‰æ•°ã®æ•°
MEAN <- as.numeric(apply(x,2,mean))
SD <- as.numeric(apply(x,2,sd))
j <- 1 #æ¨™æº–åŒ–
for (i in 1:p) {
u[j] <- x[j]- MEAN[j]
u[j] <- u[j]/SD[j]
j <- j+1
}
R <- cor(u) #ç›¸é–¢ä¿‚æ•°
z <- eigen(R)
Î» <- z$values #å›ºæœ‰å€¤
z <- z$vectors #å›ºæœ‰ãEã‚¯ãƒˆãƒ«
U <- data.matrix(u)
Z <- U%*%z #ä¸»æˆåEå¾—ç‚¹
ÎE<- Î»/p #å¯E¸ŽçŽ‡
CÎE<- ÎE#ç´¯ç©å¯E¸ŽçŽ‡
j <- 0
for (i in 1:(p-1)) {
j <- j+1
CÎ›[j+1] <- CÎ›[j] + CÎ›[j+1]
}
r <- matrix(1:p^2,nrow=p,ncol=p) #å›
å­è²
è·é‡Ej <- 1
for (i in 1:p) {
r[j,] <- sqrt(Î»[j])*z[,j]
j <- j+1
}
write.table("å›ºæœ‰å€¤",file="output.txt",append=T,quote=F,col.names=F)
write.table(t(Î»),file="output.txt",append=T,quote=F,col.names=F)
write.table("å›ºæœ‰ãEã‚¯ãƒˆãƒ«",file="output.txt",append=T,quote=F,col.names=F)
write.table(z,file="output.txt",append=T,quote=F,col.names=F)
write.table("å¯E¸ŽçŽ‡",file="output.txt",append=T,quote=F,col.names=F)
write.table(t(ÎE,file="output.txt",append=T,quote=F,col.names=F)
write.table("ç´¯ç©å¯E¸ŽçŽ‡",file="output.txt",append=T,quote=F,col.names=F)
write.table(t(CÎE,file="output.txt",append=T,quote=F,col.names=F)
write.table("å›
å­è²
è·é‡E,file="output.txt",append=T,quote=F,col.names=F)
write.table(t(colnames(x)),file="output.txt",append=T,quote=F,col.names=F)
write.table(r,file="output.txt",append=T,quote=F,col.names=F)
write.table("ä¸»æˆåEå¾—ç‚¹",file="output.txt",append=T,quote=F,col.names=F)
write.table(Z,file="output.txt",append=T,quote=F,col.names=F)
q()
